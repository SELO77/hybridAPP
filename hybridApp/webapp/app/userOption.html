<!doctype html>
<html class="no-js" lang="en">
<head>

<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<!-- -->
<title>DodamDodam</title>
<meta name="description" content="">
<meta name="viewport"
	content="width=device-width, initial-scale=1 minimum-scale=1, maximum-scale=1, user-scalable=no">
<!-- 모바일 친화적 뷰 설정 -->

<link rel="apple-touch-icon" href="apple-touch-icon.png">
<!-- Place favicon.ico in the root directory -->
<link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css">
<link rel="stylesheet" href="css/__main.css">
<link rel="stylesheet" href="css/slidebars.css">
<!-- [SELO77] css -->
<style>
#uploadUImage {
	width: 150px;
	height: 150px;
	margin-right: 10px;
	position:relative;top:60px;
}

#uploadBImage {
	width: 300px;
	height: 200px;
	margin-left: 10px;
	position:relative;top:70px;
}

.form-group span {
	font-size: 14px;
}
.uploadUImage{
	float: left;
}
</style>
</head>
<body style="padding-bottom: 110px;">
	<!--[if lt IE 8]>
						<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
						<![endif]-->

	<div style="padding: 0px 40px;">
		<form role="form">

			<div class="form-group" align="left">
				<span id="uploadUImage"></span>
			</div>


			<div class="form-group">
				<span style="position:relative;top:40px;left:10px"><icon class="fa fa-user"></icon></span>
				<span style="position:relative;left:25px;top:40px" id="nickname"></span>
			</div>


			<div class="form-group" >
				<span style="position:relative;top:40px;left:10px"><icon class="fa fa-calendar-check-o"></icon></span>
				<span style="position:relative;left:25px;top:40px" id="reg_date"></span>
			</div>	

			<div class="form-group" >
				<span style="position:relative;top:40px;left:10px"><icon class="fa fa-calendar-check-o"></icon></span>
				<span style="position:relative;left:25px;top:40px">123123</span>
			</div>	

			<div class="form-group" >
				<button type="button" class="btn btn-primary" style="position:relative;top:40px;left25px; border: 3px solid #F4C6C1; border-radius: 20px; background-color:#FE8275;" id="uUpdate">회원정보 수정</button>
			</div>

			<div class="form-group" align="right">
				<div id="uploadBImage"></div>
			</div>

			<div class="form-group" id="babyName" style="margin-left: 10px;">
				<span style="position:relative;bottom:15px;"><icon class="fa fa-user"></icon></span>
				<span style="position:relative;left:15px;bottom:15px;" id="bName"></span>
			</div>

			<div class="form-group" id="babyBirth" style="margin-left: 10px;">
				<span style="position:relative;bottom:15px;"><icon class="fa fa-calendar"></icon></span>
				<span style="position:relative;left:15px;bottom:15px;" id="bBirth"></span>
			</div>

			<div class="form-group" id="sBabyResult" style="margin-left: 10px;">
				<span style="position:relative;bottom:15px;"><icon class="fa fa-calendar"></icon></span>
				<span style="position:relative;left:15px;bottom:15px;" id="sBResult"></span>
			</div>			

			<div class="form-group" style="margin-left:10px;">
				<button type="button" class="btn btn-primary" id="bUpdate" style="position:relative;bottom:10px; border: 3px solid #F4C6C1; border-radius: 20px; background-color:#FE8275;">아이정보 수정</button>
			</div>

			<div class="form-group" align="center">
				<button type="button" class="btn btn-default" style="position:relative;top:50px; border: 3px solid #F4C6C1; border-radius: 20px;" id="logout">로그아웃</button>
			</div>			

		</form>

	</div>

	<!-- 메인 html끝 [진영]-->

	<script src="js/vendor/jquery-1.11.3.min.js"></script>





	<!-- script plug in start -->
	<script src="js/vendor/modernizr-2.8.3.min.js"></script>

	<!-- [근한] 파일업로드를 위한 js파일 추가 -->
	<script src="js/vendor/jquery.ui.widget.js"></script>
	<script src="js/jquery.fileupload.js"></script>
	<!-- /[근한] 파일업로드를 위한 js파일 추가 끝 -->

	<!-- ip 등 meta data 가져오기 -->
	<script src="js/jihoon/getMetaData.js"></script>


	<script>


				var user=getMetaData('user');
				var responseURL="mainIndex.html";
				var uUpdatePage="userinfo.html";
				var bUpdatePage="updateBaby.html";
				var userImage="";
				var babyImage="";
				var getuPhoto="";
				var getbPhoto="";
				var userFileURL="http://192.168.0.3:8080/dodam_upload/user/";
				var babyFileURL="http://192.168.0.3:8080/dodam_upload/baby/";


				$("#uUpdate").on("click",function(){
					$(window.parent.frames["innerframe"].document.location).attr("href","userinfo.html");
				});


				$("#bUpdate").on("click",function(){
					$(window.parent.frames["innerframe"].document.location).attr("href","updateBaby.html");
				});


				$("#logout").on("click",function(){
					$('frame[name="innerframe"]').attr('scrolling','auto');
					window.localStorage.removeItem("userKey");
					self.location="index.html";
				});


				/* document.addEventListener("backbutton", onBackKeyDown, false);
				function onBackKeyDown(){
					 testLogoutSheet();
				}

				//Action sheet

				function testLogoutSheet() {
					var options = {
						'androidTheme' : window.plugins.actionsheet.ANDROID_THEMES.THEME_HOLO_LIGHT,
						'title': 'Are you sure to close it?',
						'buttonLabels': ['No','Yes'],
						'androidEnableCancelButton' : true,
						'winphoneEnableCancelButton' : true,
							//'addCancelButtonWithLabel': 'Cancel'
						};
								window.plugins.actionsheet.show(options, callback);
					}

					var callback = function(buttonIndex) {
						setTimeout(function() {
							if (buttonIndex == 2) {
								navigator.app.exitApp();
							};
						});
					}; */


					$.ajax({
						url:getMetaData("ip")+"user/json/getUser",
						method:"POST",
						contentType:"application/json",
						dataType:"json",
						data:JSON.stringify({uNo:user.uNo}),
						success:function(result){
							console.log(result);

							if(result.user.uPic=="default.jpg") {
								getuPhoto=userFileURL+"back.jpg";
							}

							else if(result.user.uPic!=null && result.user.uPic!="") {
								getuPhoto=userFileURL+result.user.uPic;
							}

							$("#email").text(result.user.mail);
							$("#nickname").text(result.user.nickname);
							$("#reg_date").text(result.user.regDate);

							var img = $("<img />");
							img.attr("name",getuPhoto.replace("img/",""));
							img.attr("id","multi");
							img.attr("style", "width:150px; height:150px; margin-right:10px; margin-top: 70px; border: 5px solid #F4C6C1; float: left; border-radius:30px 30px 5px 30px");
							img.attr("src",getuPhoto);
							img.attr("class","img-rounded");

							$("#uploadUImage").append(img);
						}					
					});


					$.ajax({
						url:getMetaData("ip")+"baby/json/getUNoBaby",
						method:"POST",
						contentType:"application/json",
						dataType:"json",
						data:JSON.stringify({uNo:user.uNo}),
						success:function(result){

							if(result.resultCode==1) {
							console.log(result);

						    if(result.baby.bPhoto==null) {
								getbPhoto=babyFileURL+"baby1.jpg";
							}

							else if(result.baby.bPhoto!=null && result.baby.bPhoto!="") {
								getbPhoto=babyFileURL+result.baby.bPhoto;
							}

							$("#bName").text(result.baby.bName);
							$("#bBirth").text(result.baby.bBirth);
							$("#sBResult").text(result.baby.weight+"kg / "+result.baby.height+"cm");

							var img = $("<img />");
							img.attr("name",getbPhoto.replace("img/",""));
							img.attr("id","multi");
							img.attr("style", "width:150px; height:150px; margin-right:10px; border: 5px solid #F4C6C1; float: right; border-radius:5px 30px 30px 30px");
							img.attr("src",getbPhoto);
							img.attr("class","img-rounded");

							$("#uploadBImage").append(img);
							}

							if(result.resultCode==0) {
								var img = $("<img />");
								img.attr("name","default");
								img.attr("id","multi");
								img.attr("style", "width:300px; height:200px; margin-right:10px;");
								img.attr("src",babyFileURL+"defaultcamera.jpg");
								img.attr("class","img-rounded");
								img.attr("align","center");

								$("#uploadBImage").append(img);

								$("#babyName").remove();
								$("#babyBirth").remove();
								$("#bUpdate").remove();
								$("#sBabyResult").remove();

								$("#logout").attr("style","position:relative;top:100px; border: 3px solid #F4C6C1; border-radius: 20px;")

								$("#uploadBImage").on("click",function(){
									$(window.parent.frames["innerframe"].document.location).attr("href","updateBaby.html");
								})

							}

						}				
					});					







		</script>

	</div>
</body>
</html>
